<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot BEAM Sets — plot_beam_clin • BEAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot BEAM Sets — plot_beam_clin"><meta name="description" content="plot_beam_clin produces a matrix of feature level clinical plots for a set. Users can specify which omic/endpoint pairs they want to see as well as the number of features from the set. Default is all omic/endpoint pairs and the top feature (smallest feature-level p-value)."><meta property="og:description" content="plot_beam_clin produces a matrix of feature level clinical plots for a set. Users can specify which omic/endpoint pairs they want to see as well as the number of features from the set. Default is all omic/endpoint pairs and the top feature (smallest feature-level p-value)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BEAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/BEAMR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/annaSeffernick/BEAMR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot BEAM Sets</h1>
      <small class="dont-index">Source: <a href="https://github.com/annaSeffernick/BEAMR/blob/main/R/plot_beam_clin.R" class="external-link"><code>R/plot_beam_clin.R</code></a></small>
      <div class="d-none name"><code>plot_beam_clin.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>plot_beam_clin produces a matrix of feature level clinical plots for a set. Users can specify which omic/endpoint pairs they want to see as well as the number of features from the set. Default is all omic/endpoint pairs and the top feature (smallest feature-level p-value).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_beam_clin</span><span class="op">(</span></span>
<span>  <span class="va">beam.result</span>,</span>
<span>  beam.specs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">beam.set.pvals</span>,</span>
<span>  <span class="va">beam.feat.pvals</span>,</span>
<span>  <span class="va">set.id</span>,</span>
<span>  gene.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pair.type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  number.pairs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pair.order <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  endpt.order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title.size <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-beam-result">beam.result<a class="anchor" aria-label="anchor" href="#arg-beam-result"></a></dt>
<dd><p>A beam.stats object from compute_beam_stats</p></dd>


<dt id="arg-beam-specs">beam.specs<a class="anchor" aria-label="anchor" href="#arg-beam-specs"></a></dt>
<dd><p>A data.frame. Default NULL, in which case beam.result$beam.specs is used. Otherwise can input other beam.specs data.frame that must contain name, mtx, mdl, plot columns.</p></dd>


<dt id="arg-beam-set-pvals">beam.set.pvals<a class="anchor" aria-label="anchor" href="#arg-beam-set-pvals"></a></dt>
<dd><p>A list containing BEAMR set p-values from compute_set_pvalues.</p></dd>


<dt id="arg-beam-feat-pvals">beam.feat.pvals<a class="anchor" aria-label="anchor" href="#arg-beam-feat-pvals"></a></dt>
<dd><p>A list containing feature-level p-values from compute_feature_pvalues.</p></dd>


<dt id="arg-set-id">set.id<a class="anchor" aria-label="anchor" href="#arg-set-id"></a></dt>
<dd><p>A character specifying the name of a set. Must be in beam.result$beam.data$set.data</p></dd>


<dt id="arg-gene-name">gene.name<a class="anchor" aria-label="anchor" href="#arg-gene-name"></a></dt>
<dd><p>A character specifying a Gene Name/Symbol for the set. Default is NULL</p></dd>


<dt id="arg-pair-type">pair.type<a class="anchor" aria-label="anchor" href="#arg-pair-type"></a></dt>
<dd><p>A character vector. Default NULL, in which case clinical plots for all omic/endpoint pairs are produced. Otherwise specify pairs from beam.stats$beam.specs$name</p></dd>


<dt id="arg-number-pairs">number.pairs<a class="anchor" aria-label="anchor" href="#arg-number-pairs"></a></dt>
<dd><p>A numeric. Default 1, in which case only feature with best simple test for each pair is plotted. If &gt;1, show top n simple plots ordered by feature-level p-value</p></dd>


<dt id="arg-pair-order">pair.order<a class="anchor" aria-label="anchor" href="#arg-pair-order"></a></dt>
<dd><p>One of c("both", "omic", "endpoint"). Default is "both." Specify how to choose feature-endpoint plots to include. If "both", find the best (based on q, p, effect size) feature-omic pair for each type of omic and each endpoint separately. If "omic", within each omic, find the best feature-endpoint pair and then plot this feature with all endpoints. If "endpoint", need to specify endpt.order as the name of chosen endpoint. Then, within each omic, find the feature with best association with the selected endpoint, and plot this feature for all endpoints.</p></dd>


<dt id="arg-endpt-order">endpt.order<a class="anchor" aria-label="anchor" href="#arg-endpt-order"></a></dt>
<dd><p>Default NULL. If pair.order="endpoint", specify character with endpoint name (from beam.specs$name, after the period).</p></dd>


<dt id="arg-n-col">n.col<a class="anchor" aria-label="anchor" href="#arg-n-col"></a></dt>
<dd><p>A numeric. Specify the number of columns for the plot layout; default NULL will use the number of omics types.</p></dd>


<dt id="arg-n-row">n.row<a class="anchor" aria-label="anchor" href="#arg-n-row"></a></dt>
<dd><p>A numeric. Specify the number of rows for the plot layout; default NULL will automatically define the number of rows after number of columns specified.</p></dd>


<dt id="arg-title-size">title.size<a class="anchor" aria-label="anchor" href="#arg-title-size"></a></dt>
<dd><p>A numeric. Specify the size of individual plot titles. Default is 10.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A figure (ggarrange object)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_set_pvalues.html">compute_set_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing bootstrap results for calculating feature set p-values: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding stats for each data matrix:Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix Lesion: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.MRD29 stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.EFS stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.OS stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix RNA: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.MRD29 stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.EFS stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.OS stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found 120 rows of stats: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merging stats with feature-sets: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merged feature-set stat rows: 120</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ordering and indexing feature sets: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Cleaning up beam.stat matrices:Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 1 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 2 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 3 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 4 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 5 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 6 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 1 of 34: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 13ENSG00000081760</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 26 of 34: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 9496ENSG00000229835</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished computing p-values at: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Minimum q-value is 0.106439437831269</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating set p-value data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done creating data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating list for output.</span>
<span class="r-in"><span><span class="va">test.feat.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_feature_pvalues.html">compute_feature_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 5 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 6 of 6: Mon Jul 22 13:50:12 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-in"><span><span class="va">plot.specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="prep_beam_plot.html">prep_beam_plot</a></span><span class="op">(</span>beam.data<span class="op">=</span><span class="va">beam_stats</span><span class="op">$</span><span class="va">beam.data</span>,</span></span>
<span class="r-in"><span>                             beam.specs<span class="op">=</span><span class="va">beam_stats</span><span class="op">$</span><span class="va">beam.specs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.plot</span> <span class="op">&lt;-</span> <span class="fu">plot_beam_clin</span><span class="op">(</span>beam.result<span class="op">=</span><span class="va">beam_stats</span>, beam.specs<span class="op">=</span><span class="va">plot.specs</span>,</span></span>
<span class="r-in"><span>                            beam.set.pvals<span class="op">=</span><span class="va">test.pvals</span>,</span></span>
<span class="r-in"><span>                            beam.feat.pvals<span class="op">=</span><span class="va">test.feat.pvals</span>,</span></span>
<span class="r-in"><span>                            set.id<span class="op">=</span><span class="st">"ENSG00000099810"</span>, gene.name<span class="op">=</span><span class="st">"MTAP"</span>,</span></span>
<span class="r-in"><span>                            pair.type<span class="op">=</span><span class="cn">NULL</span>, number.pairs<span class="op">=</span><span class="fl">1</span>, n.col<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>                            n.row<span class="op">=</span><span class="cn">NULL</span>, title.size<span class="op">=</span><span class="fl">11</span>,</span></span>
<span class="r-in"><span>                            pair.order<span class="op">=</span><span class="st">"omic"</span>, endpt.order<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plot_beam_clin-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anna Eames Seffernick, Stanley Pounds, Xueyuan Cao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

