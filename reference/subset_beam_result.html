<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Subset beam.stats Result — subset_beam_result • BEAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subset beam.stats Result — subset_beam_result"><meta name="description" content="Filter the beam.stats object from compute_beam_stats with various filtering criteria. Default is to filter to top 50 sets with smallest q-value. At least one filtering criteria must be specified. Can also use intersection or union of multiple criteria."><meta property="og:description" content="Filter the beam.stats object from compute_beam_stats with various filtering criteria. Default is to filter to top 50 sets with smallest q-value. At least one filtering criteria must be specified. Can also use intersection or union of multiple criteria."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BEAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/BEAMR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/annaSeffernick/BEAMR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Subset beam.stats Result</h1>
      <small class="dont-index">Source: <a href="https://github.com/annaSeffernick/BEAMR/blob/main/R/subset_beam_result.R" class="external-link"><code>R/subset_beam_result.R</code></a></small>
      <div class="d-none name"><code>subset_beam_result.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Filter the beam.stats object from compute_beam_stats with various filtering criteria. Default is to filter to top 50 sets with smallest q-value. At least one filtering criteria must be specified. Can also use intersection or union of multiple criteria.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">subset_beam_result</span><span class="op">(</span></span>
<span>  <span class="va">beam.result</span>,</span>
<span>  beam.set.pvals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beam.feat.pvals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mtx.rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set.ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  endpts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  omics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  q.limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.feat.limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  q.feat.limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intersect <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  recalc <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-beam-result">beam.result<a class="anchor" aria-label="anchor" href="#arg-beam-result"></a></dt>
<dd><p>A beam.stats object from compute_beam_stats</p></dd>


<dt id="arg-beam-set-pvals">beam.set.pvals<a class="anchor" aria-label="anchor" href="#arg-beam-set-pvals"></a></dt>
<dd><p>A list containing BEAMR set p-values from compute_set_pvalues; required if p.limit or q.limit are specified.</p></dd>


<dt id="arg-beam-feat-pvals">beam.feat.pvals<a class="anchor" aria-label="anchor" href="#arg-beam-feat-pvals"></a></dt>
<dd><p>A list containing feature-level p-values from compute_feature_pvalues; required if p.feat.limit or q.feat.limit are specified.</p></dd>


<dt id="arg-mtx-rows">mtx.rows<a class="anchor" aria-label="anchor" href="#arg-mtx-rows"></a></dt>
<dd><p>A list of vectors of feature names corresponding to row.id in set.data. List names correspond to mtx.id in set.data. If specified, filter to all sets containing at least one of these features.</p></dd>


<dt id="arg-set-ids">set.ids<a class="anchor" aria-label="anchor" href="#arg-set-ids"></a></dt>
<dd><p>A character vector of set.ids. If specified, filter to these sets.</p></dd>


<dt id="arg-endpts">endpts<a class="anchor" aria-label="anchor" href="#arg-endpts"></a></dt>
<dd><p>A character vector of endpoint names. If specified, filter to sets that correspond to these endpoints.</p></dd>


<dt id="arg-omics">omics<a class="anchor" aria-label="anchor" href="#arg-omics"></a></dt>
<dd><p>A character vector of omics names. If specified, fitler to sets that correspond to these omics.</p></dd>


<dt id="arg-p-limit">p.limit<a class="anchor" aria-label="anchor" href="#arg-p-limit"></a></dt>
<dd><p>A numeric value. If specified, determine mtx.rows that are below this threshold if p&lt;1 or top p sets if p&gt;1.</p></dd>


<dt id="arg-q-limit">q.limit<a class="anchor" aria-label="anchor" href="#arg-q-limit"></a></dt>
<dd><p>A numeric value. If specified, determine mtx.rows that are below this threshold if q &lt;1 or top q sets if q&gt;1.</p></dd>


<dt id="arg-p-feat-limit">p.feat.limit<a class="anchor" aria-label="anchor" href="#arg-p-feat-limit"></a></dt>
<dd><p>A numeric value. If specified, determine mtx.rows that are below this threshold if p.feat&lt;1 or top p.feat sets if p.feat&gt;1 (feature p-values).</p></dd>


<dt id="arg-q-feat-limit">q.feat.limit<a class="anchor" aria-label="anchor" href="#arg-q-feat-limit"></a></dt>
<dd><p>A numeric value. If specified, determine mtx.rows that are below this threshold if q.feat&lt;1 or top q.feat sets if q.feat&gt;1.</p></dd>


<dt id="arg-intersect">intersect<a class="anchor" aria-label="anchor" href="#arg-intersect"></a></dt>
<dd><p>A logical value. Default is TRUE. If TRUE, use intersection of all specified criteria. If FALSE use union of all specified criteria.</p></dd>


<dt id="arg-recalc">recalc<a class="anchor" aria-label="anchor" href="#arg-recalc"></a></dt>
<dd><p>A logical value. Default is FALSE. If TRUE, recalculate p-values. If FALSE use original set p-values..</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with filtered beam.stats object, updated beam.set.pvals, and filtered beam.feat.pvals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">test.beam.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="prep_beam_data.html">prep_beam_data</a></span><span class="op">(</span>main.data<span class="op">=</span><span class="va">clinf</span>, mtx.data<span class="op">=</span><span class="va">omicdat</span>,</span></span>
<span class="r-in"><span>                                 mtx.anns<span class="op">=</span><span class="va">omicann</span>, set.data<span class="op">=</span><span class="va">setdat</span>,</span></span>
<span class="r-in"><span>                                 set.anns<span class="op">=</span><span class="cn">NULL</span>, n.boot<span class="op">=</span><span class="fl">10</span>, seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking inputs: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Checking that each element of mtx.data is a matrix: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Checking that each element of mtx.anns is a data.frame: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aligning main.data with each mtx.data: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.data Lesion (1 of 2): Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.data RNA (2 of 2): Fri Jul 12 18:42:02 2024</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some ids not matched; returning NAs for those.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.anns: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 1 with annotations: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 2 with annotations: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Checking set.data: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Ordering and indexing set.data: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Checking section 1 of 40 of set.data: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating bootstrap index matrix: Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Packaging and returning result: Fri Jul 12 18:42:02 2024</span>
<span class="r-in"><span><span class="va">specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="prep_beam_specs.html">prep_beam_specs</a></span><span class="op">(</span>beam.data<span class="op">=</span><span class="va">test.beam.data</span>, endpts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MRD29"</span>, <span class="st">"EFS"</span>, <span class="st">"OS"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         firth<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> MRD29 is continuous, fitting lm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> EFS is survival endpoint, fitting coxphf2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OS is survival endpoint, fitting coxphf2</span>
<span class="r-in"><span><span class="va">test.beam.stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_beam_stats.html">compute_beam_stats</a></span><span class="op">(</span>beam.data<span class="op">=</span><span class="va">test.beam.data</span>, beam.specs<span class="op">=</span><span class="va">specs</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 1 of 6 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Lesionlm(MRD29~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 2 of 6 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> RNAlm(MRD29~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 3 of 6 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Lesioncoxphf2(EFS~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:02 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:42:17 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 4 of 6 : Fri Jul 12 18:42:19 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> RNAcoxphf2(EFS~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:19 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:42:37 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 5 of 6 : Fri Jul 12 18:42:39 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Lesioncoxphf2(OS~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:39 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:42:54 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Working on analysis 6 of 6 : Fri Jul 12 18:42:55 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> RNAcoxphf2(OS~mtx.row,data=main.data,model=T)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 0 of 11 : Fri Jul 12 18:42:55 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on bootstrap 10 of 11 : Fri Jul 12 18:43:12 2024</span>
<span class="r-in"><span><span class="va">test.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_set_pvalues.html">compute_set_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">test.beam.stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing bootstrap results for calculating feature set p-values: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding stats for each data matrix:Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix Lesion: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.MRD29 stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.EFS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.OS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix RNA: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.MRD29 stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.EFS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.OS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found 120 rows of stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merging stats with feature-sets: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merged feature-set stat rows: 120</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ordering and indexing feature sets: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Cleaning up beam.stat matrices:Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 1 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 2 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 3 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 4 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 5 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 6 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 1 of 34: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 13ENSG00000081760</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 26 of 34: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 9496ENSG00000229835</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished computing p-values at: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Minimum q-value is 0.106439437831269</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating set p-value data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done creating data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating list for output.</span>
<span class="r-in"><span><span class="va">test.feat.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_feature_pvalues.html">compute_feature_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">test.beam.stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 5 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 6 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-in"><span><span class="va">filt.beam.stats</span> <span class="op">&lt;-</span> <span class="fu">subset_beam_result</span><span class="op">(</span><span class="va">test.beam.stats</span>, <span class="va">test.pvals</span>,</span></span>
<span class="r-in"><span>                                      <span class="va">test.feat.pvals</span>, endpts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EFS"</span>, <span class="st">"OS"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                      q.limit<span class="op">=</span><span class="fl">10</span>, intersect<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                      recalc<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.anns: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 1 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 2 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(set.id, mtx.id, row.id)`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.anns: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 1 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 2 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_set_pvalues.html">compute_set_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing bootstrap results for calculating feature set p-values: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding stats for each data matrix:Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix Lesion: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.MRD29 stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.EFS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with Lesion.OS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Finding stats for data matrix RNA: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.MRD29 stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.EFS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Finding features with with RNA.OS stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found 120 rows of stats: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merging stats with feature-sets: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Merged feature-set stat rows: 120</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ordering and indexing feature sets: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Cleaning up beam.stat matrices:Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 1 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 2 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 3 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 4 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 5 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Working on matrix 6 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 1 of 34: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 13ENSG00000081760</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing p-value for feature set 26 of 34: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 9496ENSG00000229835</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished computing p-values at: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Minimum q-value is 0.106439437831269</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating set p-value data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done creating data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating list for output.</span>
<span class="r-in"><span><span class="va">test.feat.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_feature_pvalues.html">compute_feature_pvalues</a></span><span class="op">(</span>beam.stats<span class="op">=</span><span class="va">beam_stats</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 5 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 6 of 6: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 20 features.</span>
<span class="r-in"><span><span class="va">filt.beam.stats</span> <span class="op">&lt;-</span> <span class="fu">subset_beam_result</span><span class="op">(</span><span class="va">beam_stats</span>, <span class="va">test.pvals</span>, <span class="va">test.feat.pvals</span>,</span></span>
<span class="r-in"><span>                                      endpts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EFS"</span>,<span class="st">"OS"</span><span class="op">)</span>, q.limit<span class="op">=</span><span class="fl">10</span>, intersect<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                      recalc<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.anns: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 1 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 2 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(set.id, mtx.id, row.id)`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Working on mtx.anns: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 1 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Matching matrix 2 with annotations: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 1 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 2 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 3 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 6 features.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing feature p-values for stat matrix 4 of 4: Fri Jul 12 18:43:14 2024</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   This matrix has 7 features.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anna Eames Seffernick, Stanley Pounds, Xueyuan Cao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

